---
sidebar_position: 2
---

# 🎨 图解绘图

这部分内容主要是介绍软件内置的**地球科学图解绘图功能模块**。涵盖了**图解模板库**的分类、管理与扩展机制（JSON/ZIP），详细解析了**绘图界面**的布局（菜单栏、功能栏、图层列表、属性面板）及其核心操作功能（如数据导入、图层编辑、视觉设置、第三方软件联动等），并提供了从选择模板到最终成图导出的**完整工作流指南**。🌍

## 目标

在图解绘图功能页面上，我们将集成更多基础图解模板，包括但不限于：构造环境判别图解、岩石分类判别图解、地质温度计基础图解等。**我们的最终目标是为地球科学创建一个全面的绘图功能集合，为研究人员提供便利**。🧪

图解模板分类逻辑上当前主要按照学科领域区分：

![Illustrated Template Classification](./imgs/Illustrated_Template_Classification.png)

:::info

随着图解模板的更新，某些分类结构可能会发生变化。

我们欢迎大家在使用过程中提供宝贵的反馈，以提高软件的可用性和便利性。🌹

:::

## 快速入门

### 图解模板库

#### 主页面

默认情况下，进入软件后绘图模块会展示内置的地球科学图解模板库（在未定义自定义图解模板的情况下），界面整体上分为三个部分：

* 左侧的图解模板列表：该列表会显示所有的模板层级情况以及对应的模板，包括自定义图解模板列表
* 右侧顶部的图解模板导航条：导航条会随着点击图解模板列表不同的层级展示不同层级的内容
* 右侧下部的图解模板卡片：显示当前点击图解模板层级下的图解卡片，包含名称和预览图

![Illustrated Template Classification](./imgs/Plot_Template_Library.png)

通过选定并点击对应的模板卡片，以进入对应的图解模板绘图界面。

**这些图解模板具有高度可扩展性**，我们采用 `JSON` 格式存储核心模板信息，并使用 `ZIP` 格式打包完整的模板资源包。借助该设计，**科研人员不仅可以自主创建图解模板，还能够将其打包后分享给其他科研人员，实现快速复用**。

**目前系统已支持在服务器端存储模板文件，从而无需更新软件即可动态刷新模板列表**。

在本地联网条件下，用户可通过菜单栏手动检查并更新内置图解模板列表，也可在设置中开启自动检查功能，以确保模板资源保持最新状态。

#### 菜单栏

菜单栏功能主要分为两个大类：

1. 文件：主要是新建图解模板，打开图解模板和导入图解模板。
   1. 新建图解模板：用户通过这个功能来新建自定义的图解，点击后会出现交互弹窗
   2. 打开图解模板：用于临时打开使用图解模板，支持打开 `json` 图解模板和打包好的 `zip` 图解模板包。
   3. 导入图解模板：用于将其他图解模板包（`zip`）导入到本地的自定义图解模板列表中。
2. 模板：主要是内置模板更新
   1. 检查内置模板更新：用于检查内置的模板列表更新，可以及时获取大量图解模板更新。
   2. 检查内置分类结构更新：用于新建图解模板的时候，提供内置的分类结构推荐。

### 绘图功能界面

#### 绘图界面

绘图界面功能主要分为四个部分：

- **功能栏**：功能栏包括一些快捷键功能和绘图，数据，编辑三大功能栏。每个功能栏都有一些对应的功能。
- **绘图对象列表区域**：即图解模板上对应的绘图元素的图层列表，可以通过点击不同的绘图元素以实现对应的属性修改。
- **绘图图解区域**：查看绘图效果、数据导入、视觉设置、绘图设置及模板说明等。
- **属性面板**：绘图元素及其属性面板列表。通过调整元素属性（例如：颜色，大小等），可以实现所需的绘图效果。

![Plot_Main_View](imgs/Plot_Main_View.png)

#### 绘图功能栏

绘图功能栏主要由 **快捷功能按钮** 和 **菜单栏** 两部分组成。 **快捷功能按钮**用于快速执行常用操作， 而**菜单栏**则提供针对不同类型的专属功能。

在默认情况下，系统会显示绘图功能栏。 对于一般用户而言，无需关注**编辑工具栏**——它主要用于制作和扩展图解模板，属于高级功能。

![plot_toolbar](imgs/plot_toolbar.png)

* 快捷功能
  * **复制到剪切板**：为了方便快速获取图解结果，我们在工具栏最上方最左边设计了一个快速复制图像到剪切板的功能操作。
  * **吸附**：默认启用，用于鼠标移动到绘图对象可以自动吸附高亮，实现用户点击即可显示对象属性。关闭后，点击绘图对象，坐标轴等不会显示对象的属性。
  * **帮助**：点击后会显示当前模板的图解指南（如果图解模板包里面含有图解指南的话）。默认情况下会查找当前软件语言的图解指南，如果不存在会使用默认的英文版本。
* 数据
  * **导入数据（Import Data）**：点击后会切换到数据功能栏。当然，你也可以直接手动切换到数据功能栏是一样的效果。后续根据数据功能栏的指示来输入数据。
  * **清除数据（Clear Data）**：点击后会清除所有已经绘制的数据点，并不会清除数据表格内的实际数据。
* 视图
  * **重置视图（Reset View）**：将绘图区域的坐标视角重置为显示最佳中心。
  * **定位轴（Coordinate）**：显示/隐藏位置定位轴；当启用时，将显示鼠标当前实时在绘图中的坐标数据。这个功能默认关闭，因为现在我们给绘图区域添加了状态栏来辅助显示坐标位置。
* 选择
  * **取消选择**：取消选择选中已选择的对象。当然，也可以直接通过单机鼠标右键来触发同样的效果。
* 导出
  * **导出**：导出当前绘图区域的内容，以 `.png`、`.jpg`、`.bmp`、`.webp` 和 `.svg` 等格式导出图像。科研条件下，我们建议使用 `svg` 矢量格式导出。
* 设置：调整绘图区域的一些其他属性
  * **图例设置**：用于调整图例的相关属性，例如位置、排列和可见性。
  * **绘图设置**：用于调整图解标题的相关属性，坐标轴标题的内容、字体、颜色等调整。
  * **脚本设置**：即当前图解模板下的，数据点计算规则，以最终实现数据投图。默认使用投图的情况下，用户不需要关注该属性。
  * **网格设置**：设置绘图界面的网格属性。
* 语言：用于实时切换图解模板的不同语言。满足国内和国际论文发布的不同要求。
* 第三方：支持将绘图区域内容直接通过第三方修图排版软件进行二次修图排版。软件目前支持的第三方修图和排版软件是：Inkscape，CorelDRAW 和 Adobe Illustrator 。可以在设置里面设置程序路径以及默认的第三方软件。

### 图层列表

绘图元素分为 7 种主要类型：

- **线条（Line）**：定义绘图基础地图边界元素的线段。
- **文本（Text）**：绘图中的文本元素用于标记。
- **多边形**：绘图中的多边形
- **箭头**：箭头绘图对象
- **函数**：用户可以输入自定义函数，并设置定义域实现自定义函数绘图。
- **坐标轴（Axes）**：用于绘图的坐标轴。
- **数据点（Data Point）**：导入的数据的数据点元素。

**默认的绘图元素渲染顺序（从顶层到底层）是：`文本 > 箭头 > 点 > 函数 > 线条 > 多边形 > 坐标轴`**。

![select_object](imgs/select_object.png)

当你选择图层面板的对应绘图元素的时候，在绘图区域会高亮显示该元素，而其他元素将会被降低透明度以去除干扰。对应的属性面板也会展示选定绘图元素的相关属性。🔍

通过对绘图对象的属性进行修改以实现相应的绘图效果。

:::tip

要取消选择所有已选择的元素，您可以通过在绘图区域鼠标右键单击或者使用绘图工具栏上的**取消选择**按钮。

:::

### 属性面板 & 图解指南

在没有选中绘图对象的情况下，属性面板是空的。只有选择了绘图对象，才会显示对应的属性面板。

需要注意的是：属性面板区域和图解指南区域是一致。两者不能同时显示。

## 使用示例

1. 首先在图解模板列表中选择自己想要使用的绘图模板，进入绘图功能页面。
2. 然后点击右上角快捷功能-帮助按钮以了解当前绘图的基本信息，主要是导入数据的格式要求
   ![plot_guide_tab](imgs/plot_guide_tab.png)
   从中可以看到，该图解模板所要求的导入数据文件的格式，例如：该图解默认需要输入四种数据：`Category`，`SiO2`，`K2O`和`Na2O`。其中地球化学元素的单位是 `wt.%` ，而对于 `Category` 这个表头的作用是负责将导入的数据根据不同的组别以生成不同的图例。
3. 在了解基础信息后，切换到数据功能栏，按照要求输入数据，即可完成数据投图，在修改绘图设置后，导出最终结果图以完成工作流程。
   ![plot_data_input](imgs/plot_data_input.png)
