---
sidebar_position: 2
---

# 🎨 圖解繪圖

這部分內容主要是介紹軟件內置的**地球科學圖解繪圖功能模塊**。涵蓋了**圖解模板庫**的分類、管理與擴展機制（JSON/ZIP），詳細解析了**繪圖界面**的布局（菜單欄、功能欄、圖層列表、屬性面板）及其核心操作功能（如數據導入、圖層編輯、視覺設置、第三方軟件聯動等），並提供了從選擇模板到最終成圖導出的**完整工作流指南**。🌍

## 目標

在圖解繪圖功能頁面上，我們將集成更多基礎圖解模板，包括但不限於：構造環境判別圖解、岩石分類判別圖解、地質溫度計基礎圖解等。**我們的最終目標是為地球科學創建一個全面的繪圖功能集合，為研究人員提供便利**。🧪

圖解模板分類邏輯上當前主要按照學科領域區分：

![Illustrated Template Classification](./imgs/Illustrated_Template_Classification.png)

:::info

隨著圖解模板的更新，某些分類結構可能會發生變化。

我們歡迎大家在使用過程中提供寶貴的反饋，以提高軟件的可用性和便利性。🌹

:::

## 快速入門

### 圖解模板庫

#### 主頁面

默認情況下，進入軟件後繪圖模塊會展示內置的地球科學圖解模板庫（在未定義自定義圖解模板的情況下），界面整體上分為三個部分：

* 左側的圖解模板列表：該列表會顯示所有的模板層級情況以及對應的模板，包括自定義圖解模板列表
* 右側頂部的圖解模板導航條：導航條會隨著點擊圖解模板列表不同的層級展示不同層級的內容
* 右側下部的圖解模板卡片：顯示當前點擊圖解模板層級下的圖解卡片，包含名稱和預覽圖

![Illustrated Template Classification](./imgs/Plot_Template_Library.png)

通過選定並點擊對應的模板卡片，以進入對應的圖解模板繪圖界面。

**這些圖解模板具有高度可擴展性**，我們採用 `JSON` 格式存儲核心模板信息，並使用 `ZIP` 格式打包完整的模板資源包。借助該設計，**科研人員不僅可以自主創建圖解模板，還能夠將其打包後分享給其他科研人員，實現快速複用**。

**目前系統已支持在服務器端存儲模板文件，從而無需更新軟件即可動態刷新模板列表**。

在本地聯網條件下，用戶可通過菜單欄手動檢查並更新內置圖解模板列表，也可在設置中開啟自動檢查功能，以確保模板資源保持最新狀態。

#### 菜單欄

菜單欄功能主要分為兩個大類：

1. 文件：主要是新建圖解模板，打開圖解模板和導入圖解模板。
   1. 新建圖解模板：用戶通過這個功能來新建自定義的圖解，點擊後會出現交互彈窗
   2. 打開圖解模板：用於臨時打開使用圖解模板，支持打開 `json` 圖解模板和打包好的 `zip` 圖解模板包。
   3. 導入圖解模板：用於將其他圖解模板包（`zip`）導入到本地的自定義圖解模板列表中。
2. 模板：主要是內置模板更新
   1. 檢查內置模板更新：用於檢查內置的模板列表更新，可以及時獲取大量圖解模板更新。
   2. 檢查內置分類結構更新：用於新建圖解模板的時候，提供內置的分類結構推薦。

### 繪圖功能界面

#### 繪圖界面

繪圖界面功能主要分為四個部分：

- **功能欄**：功能欄包括一些快捷鍵功能和繪圖，數據，編輯三大功能欄。每個功能欄都有一些對應的功能。
- **繪圖對象列表區域**：即圖解模板上對應的繪圖元素的圖層列表，可以通過點擊不同的繪圖元素以實現對應的屬性修改。
- **繪圖圖解區域**：查看繪圖效果、數據導入、視覺設置、繪圖設置及模板說明等。
- **屬性面板**：繪圖元素及其屬性面板列表。通過調整元素屬性（例如：顏色，大小等），可以實現所需的繪圖效果。

![Plot_Main_View](imgs/Plot_Main_View.png)

#### 繪圖功能欄

繪圖功能欄主要由 **快捷功能按鈕** 和 **菜單欄** 兩部分組成。 **快捷功能按鈕**用於快速執行常用操作， 而**菜單欄**則提供針對不同類型的專屬功能。

在默認情況下，系統會顯示繪圖功能欄。 對於一般用戶而言，無需關注**編輯工具欄**——它主要用於製作和擴展圖解模板，屬於高級功能。

![plot_toolbar](imgs/plot_toolbar.png)

* 快捷功能
  * **複製到剪貼板**：為了方便快速獲取圖解結果，我們在工具欄最上方最左邊設計了一個快速複製圖像到剪貼板的功能操作。
  * **吸附**：默認啟用，用於鼠標移動到繪圖對象可以自動吸附高亮，實現用戶點擊即可顯示對象屬性。關閉後，點擊繪圖對象，坐標軸等不會顯示對象的屬性。
  * **幫助**：點擊後會顯示當前模板的圖解指南（如果圖解模板包裡面含有圖解指南的話）。默認情況下會查找當前軟件語言的圖解指南，如果不存在會使用默認的英文版本。
* 數據
  * **導入數據（Import Data）**：點擊後會切換到數據功能欄。當然，你也可以直接手動切換到數據功能欄是一樣的效果。後續根據數據功能欄的指示來輸入數據。
  * **清除數據（Clear Data）**：點擊後會清除所有已經繪製的數據點，並不會清除數據表格內的實際數據。
* 視圖
  * **重置視圖（Reset View）**：將繪圖區域的坐標視角重置為顯示最佳中心。
  * **定位軸（Coordinate）**：顯示/隱藏位置定位軸；當啟用時，將顯示鼠標當前實時在繪圖中的坐標數據。這個功能默認關閉，因為現在我們給繪圖區域添加了狀態欄來輔助顯示坐標位置。
* 選擇
  * **取消選擇**：取消選擇選中已選擇的對象。當然，也可以直接通過單機鼠標右鍵來觸發同樣的效果。
* 導出
  * **導出**：導出當前繪圖區域的內容，以 `.png`、`.jpg`、`.bmp`、`.webp` 和 `.svg` 等格式導出圖像。科研條件下，我們建議使用 `svg` 矢量格式導出。
* 設置：調整繪圖區域的一些其他屬性
  * **圖例設置**：用於調整圖例的相關屬性，例如位置、排列和可見性。
  * **繪圖設置**：用於調整圖解標題的相關屬性，坐標軸標題的內容、字體、顏色等調整。
  * **腳本設置**：即當前圖解模板下的，數據點計算規則，以最終實現數據投圖。默認使用投圖的情況下，用戶不需要關注該屬性。
  * **網格設置**：設置繪圖界面的網格屬性。
* 語言：用於實時切換圖解模板的不同語言。滿足國內和國際論文發布的不同要求。
* 第三方：支持將繪圖區域內容直接通過第三方修圖排版軟件進行二次修圖排版。軟件目前支持的第三方修圖和排版軟件是：Inkscape，CorelDRAW 和 Adobe Illustrator 。可以在設置裡面設置程序路徑以及默認的第三方軟件。

### 圖層列表

繪圖元素分為 7 種主要類型：

- **線條（Line）**：定義繪圖基礎地圖邊界元素的線段。
- **文本（Text）**：繪圖中的文本元素用於標記。
- **多邊形**：繪圖中的多邊形
- **箭頭**：箭頭繪圖對象
- **函數**：用戶可以輸入自定義函數，並設置定義域實現自定義函數繪圖。
- **坐標軸（Axes）**：用於繪圖的坐標軸。
- **數據點（Data Point）**：導入的數據的數據點元素。

**默認的繪圖元素渲染順序（從頂層到底層）是：`文本 > 箭頭 > 點 > 函數 > 線條 > 多邊形 > 坐標軸`**。

![select_object](imgs/select_object.png)

當你選擇圖層面板的對應繪圖元素的時候，在繪圖區域會高亮顯示該元素，而其他元素將會被降低透明度以去除干擾。對應的屬性面板也會展示選定繪圖元素的相關屬性。🔍

通過對繪圖對象的屬性進行修改以實現相應的繪圖效果。

:::tip

要取消選擇所有已選擇的元素，您可以通過在繪圖區域鼠標右鍵單擊或者使用繪圖工具欄上的**取消選擇**按鈕。

:::

### 屬性面板 & 圖解指南

在沒有選中繪圖對象的情況下，屬性面板是空的。只有選擇了繪圖對象，才會顯示對應的屬性面板。

需要注意的是：屬性面板區域和圖解指南區域是一致。兩者不能同時顯示。

## 使用示例

1. 首先在圖解模板列表中選擇自己想要使用的繪圖模板，進入繪圖功能頁面。
2. 然後點擊右上角快捷功能-幫助按鈕以了解當前繪圖的基本信息，主要是導入數據的格式要求
   ![plot_guide_tab](imgs/plot_guide_tab.png)
   從中可以看到，該圖解模板所要求的導入數據文件的格式，例如：該圖解默認需要輸入四種數據：`Category`，`SiO2`，`K2O`和`Na2O`。其中地球化學元素的單位是 `wt.%` ，而對於 `Category` 這個表頭的作用是負責將導入的數據根據不同的組別以生成不同的圖例。
3. 在了解基礎信息後，切換到數據功能欄，按照要求輸入數據，即可完成數據投圖，在修改繪圖設置後，導出最終結果圖以完成工作流程。
   ![plot_data_input](imgs/plot_data_input.png)
