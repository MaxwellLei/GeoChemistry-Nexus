<UserControl x:Class="GeoChemistryNexus.Controls.NotificationItem"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:GeoChemistryNexus.Controls"
             xmlns:vm="clr-namespace:GeoChemistryNexus.ViewModels"
             mc:Ignorable="d" 
             xmlns:lg="clr-namespace:GeoChemistryNexus.Services"
             d:DataContext="{d:DesignInstance Type=vm:NotificationViewModel}"
             d:DesignHeight="64" d:DesignWidth="400"
             Margin="0,5">
    
    <UserControl.Resources>
        <Storyboard x:Key="SlideIn">
            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:0.3" FillBehavior="Stop">
                <DoubleAnimation.EasingFunction>
                    <ExponentialEase EasingMode="EaseOut" Exponent="6"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" From="100" To="0" Duration="0:0:0.3" FillBehavior="Stop">
                <DoubleAnimation.EasingFunction>
                    <BackEase EasingMode="EaseOut" Amplitude="0.4"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        <Storyboard x:Key="SlideOut">
            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="1" To="0" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <ExponentialEase EasingMode="EaseIn" Exponent="6"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" From="0" To="100" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <BackEase EasingMode="EaseIn" Amplitude="0.4"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
    </UserControl.Resources>
    
    <UserControl.RenderTransform>
        <TranslateTransform/>
    </UserControl.RenderTransform>

    <UserControl.Style>
        <Style TargetType="UserControl">
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsClosing}" Value="True">
                    <DataTrigger.EnterActions>
                        <BeginStoryboard Storyboard="{StaticResource SlideOut}"/>
                    </DataTrigger.EnterActions>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </UserControl.Style>
    
    <UserControl.Triggers>
        <EventTrigger RoutedEvent="Loaded">
            <BeginStoryboard Storyboard="{StaticResource SlideIn}"/>
        </EventTrigger>
    </UserControl.Triggers>

    <!-- Modern-style Glassmorphism Card -->
    <Border Background="{Binding BackgroundColor}" CornerRadius="8" BorderBrush="{Binding BorderColor}" BorderThickness="1" MinWidth="300" MaxWidth="380">
        <Border.Effect>
            <DropShadowEffect Color="Black" BlurRadius="20" ShadowDepth="4" Opacity="0.15"/>
        </Border.Effect>
        <Grid Margin="16,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Icon Container -->
            <Border Width="38" Height="38" CornerRadius="19" Background="#20000000" Margin="0,0,14,0" VerticalAlignment="Top">
                <Path Fill="{Binding ForegroundColor}" Stretch="Uniform" Width="18" Height="18" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <Path.Style>
                        <Style TargetType="Path">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Type}" Value="Success">
                                    <Setter Property="Data" Value="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Type}" Value="Warning">
                                    <Setter Property="Data" Value="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Type}" Value="Error">
                                    <Setter Property="Data" Value="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Type}" Value="Info">
                                    <Setter Property="Data" Value="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Path.Style>
                </Path>
            </Border>

            <!-- Content -->
            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                <TextBlock Text="{Binding Title}" FontWeight="Bold" FontSize="14" Foreground="{Binding ForegroundColor}" Margin="0,0,0,3"/>
                <TextBlock Text="{Binding Message}" FontSize="13" Foreground="{Binding ForegroundColor}" Opacity="0.85" TextWrapping="Wrap" LineHeight="18"/>
                
                <!-- Language Selection -->
                <StackPanel Margin="0,10,0,0">
                    <StackPanel.Style>
                        <Style TargetType="StackPanel">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsLanguageSelection}" Value="True">
                                    <Setter Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </StackPanel.Style>
                    
                    <ComboBox ItemsSource="{Binding Languages}" SelectedItem="{Binding SelectedLanguage}" 
                              Margin="0,0,0,10" Padding="6,4" BorderThickness="1" BorderBrush="{Binding BorderColor}"/>
                    
                    <StackPanel Orientation="Horizontal">
                        <Button Content="{Binding [Confirm], Source={x:Static lg:LanguageService.Instance}}" 
                                Command="{Binding SelectLanguageCommand}" 
                                Margin="0,0,10,0" Padding="12,5" Background="{Binding ForegroundColor}" Foreground="White" 
                                BorderThickness="0" Cursor="Hand" FontWeight="SemiBold">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                        
                        <Button Content="{Binding [Cancel], Source={x:Static lg:LanguageService.Instance}}" 
                                Command="{Binding CancelCommand}" 
                                Padding="12,5" Background="Transparent" Foreground="{Binding ForegroundColor}" 
                                BorderBrush="{Binding ForegroundColor}" BorderThickness="1" Cursor="Hand" FontWeight="SemiBold">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </StackPanel>
                </StackPanel>

                <!-- Action Buttons -->
                <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                    <StackPanel.Style>
                        <Style TargetType="StackPanel">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding IsInteractive}" Value="True"/>
                                        <Condition Binding="{Binding IsLanguageSelection}" Value="False"/>
                                        <Condition Binding="{Binding IsThreeButtonDialog}" Value="False"/>
                                    </MultiDataTrigger.Conditions>
                                    <Setter Property="Visibility" Value="Visible"/>
                                </MultiDataTrigger>
                            </Style.Triggers>
                        </Style>
                    </StackPanel.Style>
                    
                    <Button Content="{Binding ConfirmText}" Command="{Binding ConfirmCommand}" 
                            Margin="0,0,10,0" Padding="12,5" Background="{Binding ForegroundColor}" Foreground="White" 
                            BorderThickness="0" Cursor="Hand" FontWeight="SemiBold">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    
                    <Button Content="{Binding CancelText}" Command="{Binding CancelCommand}" 
                            Padding="12,5" Background="Transparent" Foreground="{Binding ForegroundColor}" 
                            BorderBrush="{Binding ForegroundColor}" BorderThickness="1" Cursor="Hand" FontWeight="SemiBold">
                         <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </StackPanel>

                <!-- Three Button Dialog -->
                <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                    <StackPanel.Style>
                        <Style TargetType="StackPanel">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding IsInteractive}" Value="True"/>
                                        <Condition Binding="{Binding IsThreeButtonDialog}" Value="True"/>
                                    </MultiDataTrigger.Conditions>
                                    <Setter Property="Visibility" Value="Visible"/>
                                </MultiDataTrigger>
                            </Style.Triggers>
                        </Style>
                    </StackPanel.Style>
                    
                    <Button Content="{Binding ConfirmText}" Command="{Binding ConfirmCommand}" 
                            Margin="0,0,8,0" Padding="12,5" Background="{Binding ForegroundColor}" Foreground="White" 
                            BorderThickness="0" Cursor="Hand" FontWeight="SemiBold">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    
                    <Button Content="{Binding ThirdButtonText}" Command="{Binding ThirdButtonCommand}" 
                            Margin="0,0,8,0" Padding="12,5" Background="Transparent" Foreground="{Binding ForegroundColor}" 
                            BorderBrush="{Binding ForegroundColor}" BorderThickness="1" Cursor="Hand" FontWeight="SemiBold">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    
                    <Button Content="{Binding CancelText}" Command="{Binding CancelCommand}" 
                            Padding="12,5" Background="Transparent" Foreground="{Binding ForegroundColor}" 
                            BorderBrush="{Binding ForegroundColor}" BorderThickness="1" Cursor="Hand" FontWeight="SemiBold">
                         <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </StackPanel>
            </StackPanel>

            <!-- Close Button -->
            <Button Grid.Column="2" Command="{Binding CloseCommand}" Background="Transparent" BorderThickness="0" 
                    Margin="8,-4,-4,0" VerticalAlignment="Top" HorizontalAlignment="Right" Cursor="Hand" Width="24" Height="24">
                <Button.Style>
                    <Style TargetType="Button">
                        <Setter Property="Visibility" Value="Visible"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsInteractive}" Value="True">
                                <Setter Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Button.Style>
                <Button.Template>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="12">
                            <Path Data="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" 
                                  Fill="{Binding ForegroundColor}" Width="10" Height="10" Stretch="Uniform" Opacity="0.5" 
                                  VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#10000000"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Button.Template>
            </Button>

            <!-- Copy Button -->
            <Button Grid.Column="2" Command="{Binding CopyCommand}" Background="Transparent" BorderThickness="0" 
                    Margin="8,0,-4,-4" VerticalAlignment="Bottom" HorizontalAlignment="Right" Cursor="Hand" Width="24" Height="24"
                    ToolTip="{Binding [copy_content],Source={x:Static lg:LanguageService.Instance}}">
                <Button.Style>
                    <Style TargetType="Button">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsCopyVisible}" Value="True">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Button.Style>
                <Button.Template>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="12">
                            <Path Data="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z" 
                                  Fill="{Binding ForegroundColor}" Stretch="Uniform" Width="12" Height="12" Opacity="0.5" 
                                  VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#10000000"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Button.Template>
            </Button>
        </Grid>
    </Border>
</UserControl>

